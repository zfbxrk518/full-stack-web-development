import{S as X,i as Y,s as Z,l as k,a as O,m as E,p as w,c as M,h as T,q as l,K,b as z,J as m,L as S,M as V,n as G,N as x,u as $,O as ee,v as te,f as q,d as oe,t as A,P as se,x as le,y as ae,z as ne,C as re,g as ue}from"../chunks/index-2a4cea0c.js";const C=(o,{result:e})=>{const s=async t=>{t.preventDefault();try{const a=new FormData(o),i=await fetch(o.action,{method:o.method,headers:{accept:"application/json"},body:a});i.ok?e(i,o):console.error("Fetch error: ",await i.text())}catch(a){console.error("Could not submit the form: ",a)}};return o.addEventListener("submit",s),{destroy(){o.removeEventListener("submit",s)}}};function de(o){let e,s,t,a,i,d,c,f,b,y,p,j,R,u,D,n,h,r,g,U,N,F,L,H;return{c(){e=k("div"),s=k("form"),t=k("input"),i=O(),d=k("button"),y=O(),p=k("form"),j=k("input"),u=O(),D=k("button"),r=O(),g=k("form"),U=k("button"),this.h()},l(v){e=E(v,"DIV",{class:!0});var _=w(e);s=E(_,"FORM",{action:!0,method:!0});var I=w(s);t=E(I,"INPUT",{type:!0,name:!0,class:!0}),i=M(I),d=E(I,"BUTTON",{"aria-label":!0,class:!0}),w(d).forEach(T),I.forEach(T),y=M(_),p=E(_,"FORM",{action:!0,method:!0,class:!0});var B=w(p);j=E(B,"INPUT",{type:!0,name:!0,class:!0}),u=M(B),D=E(B,"BUTTON",{"aria-label":!0,class:!0}),w(D).forEach(T),B.forEach(T),r=M(_),g=E(_,"FORM",{action:!0,method:!0});var J=w(g);U=E(J,"BUTTON",{"aria-label":!0,class:!0}),w(U).forEach(T),J.forEach(T),_.forEach(T),this.h()},h(){l(t,"type","hidden"),l(t,"name","done"),t.value=a=o[0].done?"":"true",l(t,"class","svelte-nk8g94"),l(d,"aria-label",c="Mark todo as "+(o[0].done?"not done":"done")),l(d,"class","toggle svelte-nk8g94"),l(s,"action",f="/todos/"+o[0].uid+".json?_method=patch"),l(s,"method","post"),l(j,"type","text"),l(j,"name","text"),j.value=R=o[0].text,l(j,"class","svelte-nk8g94"),l(D,"aria-label","Save todo"),l(D,"class","save svelte-nk8g94"),l(p,"action",n="/todos/"+o[0].uid+".json?_method=patch"),l(p,"method","post"),l(p,"class","text svelte-nk8g94"),l(U,"aria-label","Delete todo"),l(U,"class","delete svelte-nk8g94"),l(g,"action",N="/todos/"+o[0].uid+".json?_method=delete"),l(g,"method","post"),l(e,"class","todo svelte-nk8g94"),K(e,"done",o[0].done)},m(v,_){z(v,e,_),m(e,s),m(s,t),m(s,i),m(s,d),m(e,y),m(e,p),m(p,j),m(p,u),m(p,D),m(e,r),m(e,g),m(g,U),L||(H=[S(b=C.call(null,s,{result:o[2]})),S(h=C.call(null,p,{result:o[2]})),S(F=C.call(null,g,{result:o[1]}))],L=!0)},p(v,[_]){_&1&&a!==(a=v[0].done?"":"true")&&(t.value=a),_&1&&c!==(c="Mark todo as "+(v[0].done?"not done":"done"))&&l(d,"aria-label",c),_&1&&f!==(f="/todos/"+v[0].uid+".json?_method=patch")&&l(s,"action",f),b&&V(b.update)&&_&4&&b.update.call(null,{result:v[2]}),_&1&&R!==(R=v[0].text)&&j.value!==R&&(j.value=R),_&1&&n!==(n="/todos/"+v[0].uid+".json?_method=patch")&&l(p,"action",n),h&&V(h.update)&&_&4&&h.update.call(null,{result:v[2]}),_&1&&N!==(N="/todos/"+v[0].uid+".json?_method=delete")&&l(g,"action",N),F&&V(F.update)&&_&2&&F.update.call(null,{result:v[1]}),_&1&&K(e,"done",v[0].done)},i:G,o:G,d(v){v&&T(e),L=!1,x(H)}}}function ce(o,e,s){let{todo:t}=e,{processDeletedTodoResult:a}=e,{processUpdatedTodoResult:i}=e;return o.$$set=d=>{"todo"in d&&s(0,t=d.todo),"processDeletedTodoResult"in d&&s(1,a=d.processDeletedTodoResult),"processUpdatedTodoResult"in d&&s(2,i=d.processUpdatedTodoResult)},[t,a,i]}class ie extends X{constructor(e){super(),Y(this,e,ce,de,Z,{todo:0,processDeletedTodoResult:1,processUpdatedTodoResult:2})}}function Q(o,e,s){const t=o.slice();return t[4]=e[s],t}function W(o){let e,s;function t(){return o[3](o[4])}return e=new ie({props:{todo:o[4],processDeletedTodoResult:t,processUpdatedTodoResult:o[2]}}),{c(){le(e.$$.fragment)},l(a){ae(e.$$.fragment,a)},m(a,i){ne(e,a,i),s=!0},p(a,i){o=a;const d={};i&1&&(d.todo=o[4]),i&1&&(d.processDeletedTodoResult=t),e.$set(d)},i(a){s||(q(e.$$.fragment,a),s=!0)},o(a){A(e.$$.fragment,a),s=!1},d(a){re(e,a)}}}function fe(o){let e,s,t,a,i,d,c,f,b,y,p,j;document.title=e=P;let R=o[0],u=[];for(let n=0;n<R.length;n+=1)u[n]=W(Q(o,R,n));const D=n=>A(u[n],1,1,()=>{u[n]=null});return{c(){s=O(),t=k("div"),a=k("h1"),i=$(P),d=O(),c=k("form"),f=k("input"),b=O();for(let n=0;n<u.length;n+=1)u[n].c();this.h()},l(n){ee('[data-svelte="svelte-1uo06u1"]',document.head).forEach(T),s=M(n),t=E(n,"DIV",{class:!0});var r=w(t);a=E(r,"H1",{});var g=w(a);i=te(g,P),g.forEach(T),d=M(r),c=E(r,"FORM",{action:!0,method:!0,class:!0});var U=w(c);f=E(U,"INPUT",{type:!0,name:!0,"aria-label":!0,placeholder:!0,class:!0}),U.forEach(T),b=M(r);for(let N=0;N<u.length;N+=1)u[N].l(r);r.forEach(T),this.h()},h(){l(f,"type","text"),l(f,"name","text"),l(f,"aria-label","Add a todo"),l(f,"placeholder","+ type to add a todo"),l(f,"class","svelte-ex9siu"),l(c,"action","/todos.json"),l(c,"method","post"),l(c,"class","new svelte-ex9siu"),l(t,"class","todos svelte-ex9siu")},m(n,h){z(n,s,h),z(n,t,h),m(t,a),m(a,i),m(t,d),m(t,c),m(c,f),m(t,b);for(let r=0;r<u.length;r+=1)u[r].m(t,null);y=!0,p||(j=S(C.call(null,c,{result:o[1]})),p=!0)},p(n,[h]){if((!y||h&0)&&e!==(e=P)&&(document.title=e),h&5){R=n[0];let r;for(r=0;r<R.length;r+=1){const g=Q(n,R,r);u[r]?(u[r].p(g,h),q(u[r],1)):(u[r]=W(g),u[r].c(),q(u[r],1),u[r].m(t,null))}for(ue(),r=R.length;r<u.length;r+=1)D(r);oe()}},i(n){if(!y){for(let h=0;h<R.length;h+=1)q(u[h]);y=!0}},o(n){u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)A(u[h]);y=!1},d(n){n&&T(s),n&&T(t),se(u,n),p=!1,j()}}}const me=async({fetch:o})=>{const e=await o("/todos.json");if(e.ok)return{props:{todos:await e.json()}};const{message:s}=await e.json();return{error:new Error(s)}},P="Todo";function he(o,e,s){let{todos:t}=e;const a=async(c,f)=>{const b=await c.json();s(0,t=[...t,b]),f.reset()},i=async c=>{const f=await c.json();s(0,t=t.map(b=>b.uid===f.uid?f:b))},d=c=>{s(0,t=t.filter(f=>f.uid!==c.uid))};return o.$$set=c=>{"todos"in c&&s(0,t=c.todos)},[t,a,i,d]}class pe extends X{constructor(e){super(),Y(this,e,he,fe,Z,{todos:0})}}export{pe as default,me as load};
